{% import 'macros/form.html' as form %}
{% set action = g.form_action or '' %}

{# This provides a full page that renders a form for adding a dataset. It can
then itself be extended to add/remove blocks of functionality. #}
{% block stages %}
  {{ h.snippet('package/snippets/stages.html', stages=stage) }}
{% endblock %}

<input type="hidden" name="_ckan_phase" value="dataset_new_1" />
{# pkg_name used in 3 stage edit #}
<input type="hidden" name="pkg_name" value="{{ data.id }}" />
{% block errors %}{{ form.errors(error_summary) }}{% endblock %}

{% block basic_fields %}
<link rel="stylesheet" href="/datapackage_creator/css/styles.css">
<div id="vue-app">
  <input type="hidden" ref="userName" value="{{ c.userobj.name }}">
  <input type="hidden" ref="userEmail" value="{{ c.userobj.email }}">
  <div class="form-group control-full control-large">
    <label class="form-label" for="field-title">Title</label>
    <div class="controls ">
        <div class="form-group">
            <input type="text" v-model="form.title" class="form-control">
        </div>
    </div>
  </div>
  <div class="form-group control-full control-large">
    <label class="form-label" for="field-title">Description</label>
    <div class="controls ">
        <div class="form-group">
            <textarea v-model="form.description" class="form-control" cols="30" rows="10"></textarea>
        </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-3">
      <div class="form-group control-full control-large">
        <label class="form-label" for="field-title">Organization</label>
        <div class="controls ">
            <div class="form-group">
                <select class="form-control"  v-model="form.organization" id="">
                  <option v-for="organization in organizationOptions" :value="organization.id">[[ organization.name ]]</option>
                </select>
            </div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="form-group control-full control-large">
        <label class="form-label" for="field-title">Visibility</label>
        <div class="controls ">
            <div class="form-group">
                <select class="form-control"  v-model="form.visibility" id="">
                  <option v-for="visibility in visibilityOptions" :value="visibility">[[ visibility ]]</option>
                </select>
            </div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="form-group control-full control-large">
        <label class="form-label" for="field-title">Type</label>
        <div class="controls ">
            <div class="form-group">
                <select class="form-control"  v-model="form.type" id="">
                  <option v-for="type in typeOptions" :value="type">[[ type ]]</option>
                </select>
            </div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="form-group control-full control-large">
        <label class="form-label" for="field-title">License</label>
        <div class="controls ">
            <div class="form-group">
                <select class="form-control"  v-model="form.license" id="">
                  <option v-for="license in licenseOptions" :value="license">[[ license ]]</option>
                </select>
            </div>
        </div>
      </div>
    </div>
  </div>
  <fieldset>
    <legend>Contributors</legend>
    <div class="row" v-for="contributor in form.contributors">
      <div class="col-md-3">
        <div class="form-group control-full control-large">
          <label class="form-label" for="field-title">Type</label>
          <div class="controls ">
              <div class="form-group">
                  <select class="form-control"  v-model="contributor.type" id="">
                    <option v-for="contributor_type in contributorTypeOptions" :value="contributor_type">[[ contributor_type ]]</option>
                  </select>
              </div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="form-group control-full control-large">
          <label class="form-label" for="field-title">Name</label>
          <div class="controls ">
              <div class="form-group">
                <input type="text" class="form-control" v-model="contributor.name">
              </div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="form-group control-full control-large">
          <label class="form-label" for="field-title">Email</label>
          <div class="controls ">
              <div class="form-group">
                <input type="text" class="form-control" v-model="contributor.email">
              </div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="form-group control-full control-large">
          <label class="form-label" for="field-title">Url</label>
          <div class="controls ">
              <div class="form-group">
                <input type="text" class="form-control" v-model="contributor.url">
              </div>
          </div>
        </div>
      </div>
    </div>
    <p style="text-align: right;">
      <button @click="addContributor" class="btn btn-primary">Add Contributor</button>
    </p>
  </fieldset>
  <div class="row">
    <div class="col-md-6">
      <div class="form-group control-full control-large">
        <label class="form-label" for="field-title">Frequency</label>
        <div class="controls ">
            <div class="form-group">
                <select class="form-control"  v-model="form.frequency" id="">
                  <option v-for="frequency in frequencyOptions" :value="frequency.value">[[ frequency.name ]]</option>
                </select>
            </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="form-group control-full control-large">
        <label class="form-label" for="field-title">Tags</label>
        <div class="controls ">
            <div class="form-group">
              <input type="text" class="form-control" v-model="form.tags">
            </div>
        </div>
      </div>
    </div>
  </div>
  <p style="text-align: right;">
    <button @click="submit" class="btn btn-primary">Add Data</button>
  </p>
</div>
{% endblock %}

{% block form_actions %}
  <div class="form-actions">

  </div>
{% endblock %}
<script src="https://cdn.jsdelivr.net/npm/vue@2.7.13/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="/datapackage_creator/js/package_form.js"></script>

